---
name: card-othello-safe-change
description: カードオセロで安全に変更を完遂するための手順（仕様→テスト→実装→検証）
---

このファイルは「特定作業を完遂するための手順書」です（ゲーム仕様そのものは `01-rulebook.md`）。

## 必読（一次情報）
- 仕様（最優先）: `01-rulebook.md`
- カード定義: `cards/catalog.json`（ブラウザ用ミラー: `cards/catalog.js`）
- 作業の段取り: `AGENTS.md`
- オンライン/リプレイ計画: `ONLINE_REFACTOR_PLAN.md`

## 手順（共通）
1) 変更の種類を決める（ルール変更 / 実装の整理 / UI変更）。
2) 影響範囲を列挙する（関連ファイル、テスト、CI）。
3) ルール変更がある場合は `01-rulebook.md` を先に更新する。
4) 代表例 + 境界条件のテストを追加/更新する。
5) 実装は差分最小で、既存の共通経路を再利用する（コピペ分岐を増やさない）。
6) 変更箇所が正しく動くことを確認する（時間がかかるテストは必要なときだけ実行する）。

## 手順（カード追加）
1) `cards/catalog.json` を更新する（id/type/cost/desc）。
2) `npm run check:consistency` が通ることを確認する。
3) 代表例 + 境界条件のテストを追加する。
4) 実装を追加し、仕様（`01-rulebook.md`）と同期する。

## 手順（既存カードのルール変更）
1) `01-rulebook.md` を先に更新する。
2) テストを更新する。
3) 実装を更新する（既存の共通経路を再利用）。
4) コスト/説明が変わるなら `cards/catalog.json` も同期する。

## 手順（UI/演出の変更）
1) ルールの意味を変えない。
2) `events[] / presentationEvents[]` を元に表示する（UIがルール状態を直接いじらない）。
